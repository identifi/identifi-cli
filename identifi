#!/usr/bin/env node
'use strict';
var packageJson = require('./package.json');
var identifi = require('commander');
var api = require('identifi-lib');

identifi
  .version(packageJson.version)
  .option('-vt, --viewpoint-type [type]', 'Set trust viewpoint type')
  .option('-vv, --viewpoint-value [value]', 'Set trust viewpoint value')
  .option('-d, --max-distance [distance]', 'Maximum trust distance from viewpoint')
  .option('-l, --limit [limit]', 'Limit the amount of results')
  .option('-o, --offset [offset]', 'Offset of results list')
  .parse(process.argv);

var options = {
  viewpointType: identifi.viewpointType,
  viewpointValue: identifi.viewpointValue,
  maxDistance: identifi.maxDistance,
  limit: identifi.limit || 10,
  offset: identifi.offset || 0
};

identifi
  .command('search <idValue>')
  .action(function(query) {
    api
      .search(query, options)
      .then(function(res) {
        console.log(res);
      });
  });

identifi
  .command('overview <idType> <idValue>')
  .action(function(type, value, options) {
    api
      .get_overview(type, value)
      .then(function(res) {
        console.log(res);
      });
  });

identifi
  .command('received <idType> <idValue>')
  .action(function(type, value, options) {
    api
      .get_received(type, value)
      .then(function(res) {
        console.log(res);
      });
  });
  
identifi
  .command('sent <idType> <idValue>')
  .action(function(type, value, options) {
    api
      .get_sent(type, value)
      .then(function(res) {
        console.log(res);
      });
  });

identifi
  .command('identity <idType> <idValue>')
  .action(function(type, value, options) {
    api
      .get_connections(type, value)
      .then(function(res) {
        console.log(res);
      });
  });

module.exports = identifi; 

identifi.parse(process.argv);
